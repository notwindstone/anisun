gonna refactor cuz this is kinda a mess
